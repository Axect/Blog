---
title: "🏫 고등학교 수학으로 이해하는 선형회귀"
date: 2021-03-09T22:01:39+09:00
draft: true
toc: true
images:
tags:
  - statistics
  - julia
  - linear regression
  - highschool
---

{{<img src="/posts/images/breakthrough2016.gif" caption="[2016 Breakthrough of the year](https://www.youtube.com/watch?v=2ncTCM7t79o)">}}

&emsp;&emsp;세계에서 가장 유명하고 권위있는 과학저널인 사이언스(Science)에서는 매년 그 해의 가장 성공적이었다고 여겨지는 과학성과를 발표합니다. 2016년 12월 22일에도 {{<emph "2016 Breakthrough of the year">}} 를 발표하면서 2016년에 있었던 과학 성과 중 가장 눈여겨봐야 할 10개의 과학성과를 발표했습니다. 순위는 다음과 같습니다.${}^{[1]}$

1. **중력파 발견**
2. **외계행성 '프록시마b' 발견**
3. **인공지능 '알파고'와 이세돌 9단의 대결**
4. **세포 노화 및 회춘 연구**
5. **유인원의 마음 읽기 능력 연구**
6. **단백질 구조설계 기술**
7. **배아줄기세포로 만든 인공난자**
8. **초기 인류의 확산 경로 연구**
9. **휴대용 DNA 분석기**
10. **초박막 메타렌즈 기술**

2016년에는 중력파 관측이라는 엄청난 업적이 있었습니다. 이는 아인슈타인이 1916년 일반상대성이론을 발표한 지 정확히 100년이 되는 해에 이룬, 인류의 물리학 역사에 길이 남을 업적이었고, 실제로 중력파 관측에 지대한 공을 세운 세 명의 과학자는 1년만에 2017년 노벨 물리학상을 수상하였습니다. 그에 걸맞게 여러 매체에서도 동시에 보도하여, 과학에 관심있는 사람이라면 2016년을 중력파의 해로 기억하고 있을 겁니다.

하지만 여기서 말하고자 하는 것은 3번입니다. 아마도 대중에게는 1번보다 3번이 더 유명한 사건이었고, 특히 한국인들에게는 더더욱 잘 알려진 사건입니다. 중력파의 발견이 이후 천문학과 물리학의 새로운 연구방향을 제시했다면, 알파고의 바둑 정복은 이후 우리의 모든 삶에 머신러닝을 침투시키는 계기가 되었습니다. 이제는 어느 서비스에서나 머신러닝을 위시한 인공지능을 사용한다는 말이 들려오고, 대학들은 앞다투어 머신러닝 및 인공지능 관련 학과를 설치하고 있습니다. 이에 머신러닝을 공부해야겠다고 마음먹고 검색해보면, 여러 블로그에서 텐서플로우(Tensorflow), 파이토치(Pytorch), 케라스(Keras) 등으로 손글씨 인식하기 등의 머신러닝 응용에 대해서 다루는 것을 볼 수 있습니다. 하지만 **왜 그렇게 되는 건지**에 대해서 찾다보면 수 많은 논문들이 등장하며 여러 전문용어들이 쏟아져서 일반인들에게는 접근 자체가 어렵습니다. 따라서 이 게시물에서는 머신러닝의 가장 기본이 되는 {{<emph "MLE(Maximum Likelihood Estimation; 최대 가능도 추정)">}}에 대해 {{<emph "고등학교 수준의 수학">}}만 가지고 다뤄보려 합니다.

-----

## 1. 데이터의 확률화

> **이해하기 위해 필요한 개념**
> * 고교 교과과정 - 확률과 통계

### 1.1. 기본 표기법

&emsp;&emsp;MLE를 시작하기에 앞서 고등학교때 배운 확률과 통계를 이용하여 데이터를 표현하는 것부터 연습하겠습니다. 표기 방식은 아주 유명한 머신러닝 책인 {{<emph "Bishop의 PRML(Pattern Recognition and Machine Learning; 패턴인식과 머신러닝)에서 사용하는 표기법">}}을 사용하겠습니다. 대부분 고등학교 표기방식과 동일합니다만, 조금의 차이가 있습니다. 저희가 사용할 표기법은 다음과 같습니다.

개념 | 표기법 | 고교 표기
:-------: | :-------: | :----:
단일 스칼라 확률변수 | $x \in \mathbb{R}$ | 집합 $X$
확률분포함수 | $p(x) \geq 0$ | $P(X=x) \geq 0$
결합확률분포 | $p(x,y)$ | --
조건부확률분포 | $p(x \| y)$ | --
균등분포 | $\text{Unif}(x\|a,b)$ | --
이항분포 | $\text{Bin}(x\|N, \mu)$ | $B(n, p)$
정규분포 | $\mathcal{N}(x\|\mu,\sigma^2)$ | $N(m,\sigma^2)$ 

위에서 보면 알겠지만, 고등학교에서 다룬 확률분포함수는 오로지 단일 확률분포일뿐, 결합이나 조건부 등의 변수가 2개 이상인 확률분포함수는 다루지 않았습니다. 다만, 그에 상응하는 확률인 곱사건의 확률($P(A\cap B)$이나 조건부확률($P(A|B)$) 자체는 다루었으니 비슷한 맥락으로 접근하면 쉽게 이해할 수 있습니다. 예를 들어, 조건부확률분포와 결합확률분포 사이에는 다음의 관계식이 성립합니다.

$$
p(x|y) = \frac{p(x,y)}{p(y)}
$$

이는 고등학교에서 다루었던 조건부확률의 정의와 부합합니다.

$$
P(X | Y) = \frac{P(X\cap Y)}{P(Y)}
$$

이쯤에서 헷갈리기 시작합니다. 도대체, 확률분포와 확률의 차이는 뭘까요?

&nbsp;

### 1.2. 확률 vs 확률분포

다음 고등학교 문제를 봅시다.

> Q. 주사위를 720번 던져서 1의 눈이 140번 이상 나올 확률은 얼마인가?

이 문제는 큰 수의 법칙을 다루는 전형적인 문제로 이항분포에서 평균과 표준편차를 구한 후 정규분포로 근사하여 푸는 문제입니다. 이 문제를 푸는 방법은 다음과 같습니다.

> 주사위의 1의 눈이 나오는 횟수를 확률변수 $X$라 두자. 이때, 주사위를 던지는 것은 모두 독립시행이므로 이 확률변수는 이항분포를 따르게 된다.
> $$p(x) = \text{Bin}(x | 720,\frac{1}{6})$$
> 이항분포 $\text{Bin}(x | n,p)$의 평균은 $np$이며 분산은 $npq$이므로, 평균은 $120$, 표준편차는 $10$이다. 이때, $720$은 충분히 큰 수이므로 확률분포가 다음의 정규분포를 따른다고 근사할 수 있다.
> $$p(x) \simeq \mathcal{N}(x | 120, 10^2)$$
> 이때, 140번 이상 나올 확률을 나타내고, 표준화하는 과정은 다음과 같다.
> $$p(x \geq 300) = p(z \geq \frac{140 - 120}{10}) = p(z \geq 2)$$
> 이를 표준정규분포표로 계산하면 $0.0228$이 나온다.

언뜻보면 위 문제는 720번의 시행이 전제되어있으므로 데이터를 다루는 것처럼 보입니다. 그리고 문제를 풀때에는 오로지 단일 확률변수만 사용하고 있습니다. 고교에서는 이런 문제들만 다루기에 데이터를 다루는데에 여러가지 확률변수가 필요하다는 것을 이해하기가 어렵습니다.
하지만, 위 문제는 전혀 데이터를 다룬 문제가 아닙니다. 오로지 정규분포에 근거한 수학적 확률을 묻는 문제일 뿐입니다. 실제 데이터를 다룬 이항분포 문제는 다음과 같습니다.

> Q. 동일한 주사위를 120번 던지는 시행을 6번 반복하여 1의 눈이 나온 데이터는 다음과 같다.
> 
> 시행 | 1 | 2 | 3 | 4 | 5 | 6
> :--: | :--: | :--: | :--: | :--: | :--: | :--:
> 횟수 | 10 | 23 | 18 | 15 | 26 | 21 
>
> 이를 이용하여 이 주사위를 720번 던졌을 때, 1의 눈이 140번 이상 나올 확률을 계산하시오.

문제가 사뭇 달라졌습니다. 앞서서 풀었던 고교문제는 오로지 수학적 확률을 가정하여 주사위의 1의 눈이 나올 확률은 $1/6$으로 고정하고 이항분포로 풀었지만, 여기서는 실제 데이터로 이항분포를 추정하여 풀어야 합니다. 추정과정은 다음과 같습니다.

1. 각 시행 횟수를 확률변수 $x_1,\,x_2,\,\cdots,\,x_6$으로 둔다.
2. 각 확률변수들은 모두 독립이라 가정하며 동일한 이항분포 $\text{Bin}(120,p)$를 따른다고 가정한다.
3. 최대가능도추정이나 베이즈 추론을 이용하여 $p$를 추정한다.

여기서는 3번에서 최대가능도추정을 이용할텐데, 아직 최대가능도추정을 배우지 않았으니, 계산결과만 명시하면 $p$는 $113/720$이라는 결과가 나옵니다. 이를 이용하여 계산하면 평균과 분산이 이전과 달라집니다. 평균은 $113$으로 주어지고, 표준편차는 약 $9.76$정도로 주어집니다. 따라서 확률을 계산하면 다음과 같습니다.

$$
p(x \geq 140) = p(z \geq \frac{140 - 113}{9.76}) \simeq p(z \geq 2.77) \simeq 0.0028)
$$

앞선 결과와 거의 10배에 해당하는 차이를 보입니다. 데이터가 6개 밖에 되지 않아 충분하지 않았기 때문입니다. 실제로 데이터를 10000개 정도로 늘린 후에 계산한 확률은 $0.0220$정도로 수학적 확률과 좀 더 비슷한 결과를 보입니다. 이 과정을 Julia 코드로 나타내면 다음과 같습니다.

```julia
using Distributions

b = Binomial(120, 1/6);   # 이항분포 선언
x = rand(b, 10000);       # 데이터 추출
y = x ./ 120;             # 확률로 변환

p = mean(y);              # 최대가능도추정으로 구한 p

b2 = Binomial(720, p);    # 구한 이항분포
m = mean(b2);             # 평균
sigma = std(b2);          # 표준편차
t = (140 - m) / sigma     # 140의 표준화

n = Normal(0,1)           # 표준정규분포
result = 1 - cdf(n, t)    # 결과
@show result              # 결과 출력
```

그럼 이제 본격적으로 데이터를 확률화시키는 과정에 대해 알아봅시다.

&nbsp;

### 1.3. 데이터의 확률분포

앞서 봤다시피, 데이터는 

-----

## 전체 확률의 법칙과 베이즈 정리


-----
## 출처

[1] : [서울신문 - 올해의 과학 성과 1위는 '중력파' 탐지](http://m.seoul.co.kr/news/newsView.php?cp=seoul&id=20161223011007)